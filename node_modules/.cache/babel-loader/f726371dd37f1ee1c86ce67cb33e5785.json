{"ast":null,"code":"/*\nTHIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT (\"AGREEMENT\") LOCATED HERE:\nhttps://www.infragistics.com/legal/license/igultimate-la\nhttps://www.infragistics.com/legal/license/igultimate-eula\nGOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.\n*/\nimport * as tslib_1 from \"tslib\";\nimport { Base, Number_$type, markType } from \"./type\";\nimport { List$1 } from \"./List$1\";\nimport { HeatTileImageCreatedEventArgs } from \"./HeatTileImageCreatedEventArgs\";\nimport { truncate, isNaN_, logBase } from \"./number\";\n/**\n * @hidden\n */\n\nvar HeatTileGeneratorWorker =\n/** @class */\n\n/*@__PURE__*/\nfunction (_super) {\n  tslib_1.__extends(HeatTileGeneratorWorker, _super);\n\n  function HeatTileGeneratorWorker(a) {\n    var _this = _super.call(this) || this;\n\n    _this.f = null;\n    _this.a = null;\n    _this.n = 0;\n    _this.o = 0;\n    _this.p = 0;\n    _this.w = null;\n    _this.u = 0;\n    _this.h = false;\n    _this.r = 0;\n    _this.i = 0;\n    _this.j = 0;\n    _this.k = 0;\n    _this.l = 0;\n    _this._completedSink = null;\n    _this.f = a;\n    HeatTileGeneratorWorker.s++;\n\n    if (HeatTileGeneratorWorker.s == 0x7FFFFFFFFFFFFFFF) {\n      HeatTileGeneratorWorker.s = 0;\n    }\n\n    _this.r = HeatTileGeneratorWorker.s;\n    return _this;\n  }\n\n  Object.defineProperty(HeatTileGeneratorWorker.prototype, \"t\", {\n    get: function () {\n      return this.r;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HeatTileGeneratorWorker.prototype, \"g\", {\n    get: function () {\n      return this.f;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  HeatTileGeneratorWorker.prototype.doWork = function () {\n    var a = this.g.blurRadius;\n    var b = a;\n    var c = this.g.maxBlurRadius;\n    var d = this.g.scaler;\n    this.n = this.g.x;\n    this.o = this.g.y;\n    this.p = this.g.z;\n\n    if (this.g.useBlurRadiusAdjustedForZoom && this.p > 0) {\n      var e = Math.sqrt(1 * 1 + 1 * 1) * Math.pow(2, this.p - 1);\n      b = a * e;\n    }\n\n    if (!isNaN_(c)) {\n      if (b > c) {\n        b = c;\n      }\n    }\n\n    var f = this.g.xValues;\n    var g = this.g.yValues;\n    var h = this.g.values;\n    var i = this.g.xValues.length;\n    var j = this.g.yValues.length;\n    var k;\n    var l;\n    var m;\n    var n;\n    var o;\n    var p;\n    var q;\n    var r = this.g.minimumVisibleLongitude;\n    var s = this.g.maximumVisibleLongitude;\n    var t = this.g.minimumVisibleLatitude;\n    var u = this.g.maximumVisibleLatitude;\n    var v = this.q(this.g.tileViewport, b);\n    var w = this.c(v, b);\n    var x = Math.abs(d.t(0, this.g.window, this.g.tileViewport) - d.t(b, this.g.window, this.g.tileViewport));\n    var y = Math.abs(d.u(0, this.g.window, this.g.tileViewport) - d.u(b, this.g.window, this.g.tileViewport));\n    var z;\n    var aa;\n    var ab = new List$1(Number_$type, 0);\n    var ac = new List$1(Number_$type, 0);\n    var ad = new List$1(Number_$type, 0);\n\n    for (var ae = 0; ae < i; ae++) {\n      k = f[ae];\n      l = g[ae];\n      m = h[ae];\n      n = k - y;\n      o = k + y;\n      p = l - x;\n      q = l + x;\n\n      if (o < r || q < t || p > u || n > s) {\n        continue;\n      }\n\n      ab.add(k);\n      ac.add(l);\n      ad.add(m);\n    }\n\n    var af = this.d(this.g.tileViewport);\n    var ag = this.b(this.g.tileViewport);\n    var ah = truncate(this.g.tileViewport.width);\n    var ai = ac.count;\n    d.v(ac, this.g.window, this.g.tileViewport);\n    d.w(ab, this.g.window, this.g.tileViewport);\n    var aj;\n    var ak;\n    var al;\n    var am;\n\n    for (var an = 0; an < ai; an++) {\n      z = truncate(Math.floor(ab._inner[an] - b));\n      aa = truncate(Math.floor(ac._inner[an] - b));\n\n      for (var ao = z; ao < z + v; ao++) {\n        for (var ap = aa; ap < aa + v; ap++) {\n          aj = ao - z;\n          ak = ap - aa;\n\n          if (ao < 0 || ao > ah - 1 || ap < 0 || ap > ah - 1) {\n            continue;\n          }\n\n          al = w[ak * v + aj];\n          am = ad._inner[an] * al;\n          ag[ap * ah + ao] = ag[ap * ah + ao] + am;\n        }\n      }\n    }\n\n    var aq = ag.length;\n    var ar = -1.7976931348623157E+308;\n    var as = 1.7976931348623157E+308;\n    var at;\n\n    if (!isNaN_(this.g.globalMinimum) && !isNaN_(this.g.globalMaximum) && this.g.useGlobalMinMax && !this.g.testRun) {\n      as = this.g.globalMinimum;\n      ar = this.g.globalMaximum;\n\n      if (!isNaN_(this.g.minimumValue)) {\n        as = this.g.minimumValue;\n      }\n\n      if (!isNaN_(this.g.maximumValue)) {\n        ar = this.g.maximumValue;\n      }\n    } else if (!isNaN_(this.g.minimumValue) && !isNaN_(this.g.maximumValue)) {\n      as = this.g.minimumValue;\n      ar = this.g.maximumValue;\n    } else {\n      var au = -1;\n      var av = -1;\n\n      for (var aw = 0; aw < aq; aw++) {\n        at = ag[aw];\n\n        if (at > 0) {\n          if (at > ar) {\n            ar = at;\n            au = aw;\n          }\n\n          if (at < as) {\n            as = at;\n            av = aw;\n          }\n        }\n      }\n\n      var ax = truncate(Math.floor(au / ah));\n      var ay = au % ah;\n      var az = truncate(Math.floor(av / ah));\n      var a0 = av % ah;\n      this.g.globalMinimum = as;\n      this.g.globalMaximum = ar;\n      var a1 = 0;\n      var a2 = 0;\n      var a3 = 0;\n      var a4 = 0;\n      var a5 = 0;\n      var a6 = 0;\n\n      for (var a7 = 0; a7 < ai; a7++) {\n        z = truncate(Math.floor(ab._inner[a7] - b));\n        aa = truncate(Math.floor(ac._inner[a7] - b));\n\n        for (var a8 = z; a8 < z + v; a8++) {\n          for (var a9 = aa; a9 < aa + v; a9++) {\n            aj = a8 - z;\n            ak = a9 - aa;\n\n            if (a8 < 0 || a8 > ah - 1 || a9 < 0 || a9 > ah - 1) {\n              continue;\n            }\n\n            if (a8 == ay && a9 == ax) {\n              a1++;\n              a3 = a3 + d.t(ac._inner[a7], this.g.window, this.g.tileViewport);\n              a4 = a4 + d.u(ab._inner[a7], this.g.window, this.g.tileViewport);\n            }\n\n            if (a8 == a0 && a9 == az) {\n              a2++;\n              a5 = a5 + d.t(ac._inner[a7], this.g.window, this.g.tileViewport);\n              a6 = a6 + d.u(ab._inner[a7], this.g.window, this.g.tileViewport);\n            }\n          }\n        }\n      }\n\n      this.i = a3 / a1;\n      this.j = a4 / a1;\n      this.k = a5 / a2;\n      this.l = a6 / a2;\n\n      if (!isNaN_(this.g.minimumValue)) {\n        as = this.g.minimumValue;\n      }\n\n      if (!isNaN_(this.g.maximumValue)) {\n        ar = this.g.maximumValue;\n      }\n    }\n\n    if (!this.g.testRun) {\n      this.x(af, ag, ar, as);\n      this.a = af;\n    }\n\n    this.z();\n  };\n\n  HeatTileGeneratorWorker.prototype.x = function (a, b, c, d) {\n    var e;\n    var f = b.length;\n\n    if (this.g.useLogarithmicScale) {\n      if (d <= 0) {\n        d = 0;\n      } else {\n        d = logBase(d, this.g.logarithmBase);\n      }\n\n      if (c <= 0) {\n        c = 0;\n      } else {\n        c = logBase(c, this.g.logarithmBase);\n      }\n    }\n\n    var g = 0;\n    var h = c - d;\n\n    if (isNaN_(h) || h <= 0) {\n      h = 1;\n    }\n\n    var i;\n    var j;\n    var k;\n    var l;\n    var m = this.g.useLogarithmicScale;\n    var n = this.g.logarithmBase;\n\n    if (this.g.scaleColors != null) {\n      var o = new Array(this.g.scaleColors.length);\n      var p = new Array(this.g.scaleColors.length);\n      var q = new Array(this.g.scaleColors.length);\n      var r = new Array(this.g.scaleColors.length);\n      var s = new Array(this.g.scaleColors.length);\n      var t = new Array(this.g.scaleColors.length);\n      var u = new Array(this.g.scaleColors.length);\n      var v = new Array(this.g.scaleColors.length);\n      var w = new Array(this.g.scaleColors.length);\n      var x = new Array(this.g.scaleColors.length);\n      var y = new Array(this.g.scaleColors.length);\n      var z = new Array(this.g.scaleColors.length);\n      var aa = this.g.scaleColorOffsets;\n\n      if (aa == null || aa.length != this.g.scaleColors.length) {\n        aa = new Array(this.g.scaleColors.length);\n\n        if (aa.length == 1) {\n          aa[0] = 0;\n        } else {\n          for (var ab = 0; ab < this.g.scaleColors.length; ab++) {\n            aa[ab] = ab / (this.g.scaleColors.length - 1);\n          }\n        }\n      }\n\n      for (var ac = 0; ac < this.g.scaleColors.length; ac++) {\n        o[ac] = this.g.scaleColors[ac].l;\n        q[ac] = this.g.scaleColors[ac].o;\n        s[ac] = this.g.scaleColors[ac].n;\n        u[ac] = this.g.scaleColors[ac].m;\n\n        if (ac < this.g.scaleColors.length - 1) {\n          p[ac] = this.g.scaleColors[ac + 1].l;\n          r[ac] = this.g.scaleColors[ac + 1].o;\n          t[ac] = this.g.scaleColors[ac + 1].n;\n          v[ac] = this.g.scaleColors[ac + 1].m;\n        } else {\n          p[ac] = this.g.scaleColors[ac].l;\n          r[ac] = this.g.scaleColors[ac].o;\n          t[ac] = this.g.scaleColors[ac].n;\n          v[ac] = this.g.scaleColors[ac].m;\n        }\n\n        w[ac] = p[ac] - o[ac];\n        x[ac] = r[ac] - q[ac];\n        y[ac] = t[ac] - s[ac];\n        z[ac] = v[ac] - u[ac];\n      }\n\n      for (var ad = 0; ad < f; ad++) {\n        e = b[ad];\n\n        if (e == 0) {\n          continue;\n        }\n\n        if (m) {\n          if (e <= 0) {\n            e = 0;\n          } else {\n            e = logBase(e, n);\n          }\n        }\n\n        g = (e - d) / h;\n\n        if (g < 0) {\n          g = 0;\n        }\n\n        if (g > 1) {\n          g = 1;\n        }\n\n        var ae = 0;\n\n        for (var af = 0; af < aa.length; af++) {\n          if (aa[af] >= g) {\n            ae = af - 1;\n            break;\n          }\n        }\n\n        if (ae > aa.length - 2) {\n          ae = aa.length - 2;\n        }\n\n        if (ae < 0) {\n          ae = 0;\n        }\n\n        g = (g - aa[ae]) / (aa[ae + 1] - aa[ae]);\n        i = truncate(Math.floor(o[ae] + g * w[ae]));\n        j = truncate(Math.floor(q[ae] + g * x[ae]));\n        k = truncate(Math.floor(s[ae] + g * y[ae]));\n        l = truncate(Math.floor(u[ae] + g * z[ae]));\n        a[4 * ad] = i;\n        a[4 * ad + 1] = j;\n        a[4 * ad + 2] = k;\n        a[4 * ad + 3] = l;\n      }\n    } else {\n      var ag = this.g.minimumColor.l;\n      var ah = this.g.maximumColor.l;\n      var ai = this.g.minimumColor.o;\n      var aj = this.g.maximumColor.o;\n      var ak = this.g.minimumColor.n;\n      var al = this.g.maximumColor.n;\n      var am = this.g.minimumColor.m;\n      var an = this.g.maximumColor.m;\n      var ao = ah - ag;\n      var ap = aj - ai;\n      var aq = al - ak;\n      var ar = an - am;\n\n      for (var as = 0; as < f; as++) {\n        e = b[as];\n\n        if (e == 0) {\n          continue;\n        }\n\n        if (m) {\n          e = logBase(e, n);\n        }\n\n        g = (e - d) / h;\n\n        if (g < 0) {\n          g = 0;\n        }\n\n        if (g > 1) {\n          g = 1;\n        }\n\n        i = truncate(Math.floor(ag + g * ao));\n        j = truncate(Math.floor(ai + g * ap));\n        k = truncate(Math.floor(ak + g * aq));\n        l = truncate(Math.floor(am + g * ar));\n        a[4 * as] = i;\n        a[4 * as + 1] = j;\n        a[4 * as + 2] = k;\n        a[4 * as + 3] = l;\n      }\n    }\n  };\n\n  HeatTileGeneratorWorker.prototype.b = function (a) {\n    var b = new Array(truncate(a.width) * truncate(a.height));\n\n    for (var c = 0; c < b.length; c++) {\n      b[c] = 0;\n    }\n\n    return b;\n  };\n\n  HeatTileGeneratorWorker.prototype.d = function (a) {\n    var b = new Array(truncate(a.width) * truncate(a.height) * 4);\n\n    for (var c = 0; c < b.length; c++) {\n      b[c] = 0;\n    }\n\n    return b;\n  };\n\n  HeatTileGeneratorWorker.prototype.c = function (a, b) {\n    var c = new Array(a * a);\n\n    for (var d = 0; d < c.length; d++) {\n      c[d] = 0;\n    }\n\n    var e = a / 2;\n    var f = a / 2;\n\n    for (var g = 0; g < a; g++) {\n      for (var h = 0; h < a; h++) {\n        var i = Math.sqrt(Math.pow(g - f, 2) + Math.pow(h - f, 2));\n\n        if (i > e) {\n          c[h * a + g] = 0;\n        } else {\n          c[h * a + g] = e - i;\n        }\n      }\n    }\n\n    var j = 0;\n    var k = -1.7976931348623157E+308;\n    var l = 1.7976931348623157E+308;\n\n    for (var m = 0; m < a; m++) {\n      for (var n = 0; n < a; n++) {\n        var o = c[n * a + m];\n\n        if (o == 0) {\n          continue;\n        }\n\n        j += o;\n        k = o > k ? o : k;\n        l = o < l ? o : l;\n      }\n    }\n\n    for (var p = 0; p < a; p++) {\n      for (var q = 0; q < a; q++) {\n        var r = c[q * a + p];\n\n        if (r == 0) {\n          continue;\n        }\n\n        var s = (r - l) / (k - l);\n        c[q * a + p] = 0.01 + s * 0.99;\n      }\n    }\n\n    c[truncate(f) * a + truncate(f)] = 1;\n    return c;\n  };\n\n  HeatTileGeneratorWorker.prototype.q = function (a, b) {\n    return truncate(Math.floor(b * 2));\n  };\n\n  HeatTileGeneratorWorker.prototype.z = function () {\n    var _this = this;\n\n    if (this.completedSink == null) {\n      return;\n    }\n\n    this.completedSink.onCompleted(function () {\n      var $ret = new HeatTileImageCreatedEventArgs();\n      $ret.url = _this.w;\n      $ret.x = _this.n;\n      $ret.y = _this.o;\n      $ret.z = _this.p;\n      $ret.globalMinimumValue = _this.g.globalMinimum;\n      $ret.globalMaximumValue = _this.g.globalMaximum;\n      $ret.globalMaximumValueLongitude = _this.j;\n      $ret.globalMaximumValueLatitude = _this.i;\n      $ret.globalMinimumValueLongitude = _this.l;\n      $ret.globalMinimumValueLatitude = _this.k;\n      $ret.imageData = _this.a;\n      $ret.image = _this.g.image;\n      return $ret;\n    }());\n  };\n\n  Object.defineProperty(HeatTileGeneratorWorker.prototype, \"completedSink\", {\n    get: function () {\n      return this._completedSink;\n    },\n    set: function (a) {\n      this._completedSink = a;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  HeatTileGeneratorWorker.$t = markType(HeatTileGeneratorWorker, 'HeatTileGeneratorWorker');\n  HeatTileGeneratorWorker.v = {};\n  HeatTileGeneratorWorker.s = 0;\n  HeatTileGeneratorWorker.m = 0;\n  return HeatTileGeneratorWorker;\n}(Base);\n\nexport { HeatTileGeneratorWorker };","map":{"version":3,"sources":["../../../../src/igniteui-core/lib/HeatTileGeneratorWorker.ts"],"names":[],"mappings":"AAAA;;;;;;;AAOA,SAAS,IAAT,EAAe,YAAf,EAAmC,QAAnC,QAAmD,QAAnD;AAIA,SAAS,MAAT,QAAuB,UAAvB;AAGA,SAAS,6BAAT,QAA8C,iCAA9C;AAEA,SAAS,QAAT,EAAmB,MAAnB,EAA2B,OAA3B,QAA0C,UAA1C;AAEA;;;;AAGA,IAAA,uBAAA;AAAA;;AAAA;AAAA,UAAA,MAAA,EAAA;AAA6C,EAAA,OAAA,CAAA,SAAA,CAAA,uBAAA,EAAA,MAAA;;AAmB5C,WAAA,uBAAA,CAAY,CAAZ,EAA+B;AAA/B,QAAA,KAAA,GACC,MAAA,CAAA,IAAA,CAAA,IAAA,KAAO,IADR;;AAjBQ,IAAA,KAAA,CAAA,CAAA,GAAsB,IAAtB;AACA,IAAA,KAAA,CAAA,CAAA,GAAc,IAAd;AACA,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,CAAA,GAAY,IAAZ;AAGR,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,CAAA,GAAa,KAAb;AACQ,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AAkaA,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,CAAA,GAAY,CAAZ;AACA,IAAA,KAAA,CAAA,cAAA,GAAyC,IAAzC;AA7ZP,IAAA,KAAI,CAAC,CAAL,GAAS,CAAT;AACA,IAAA,uBAAuB,CAAC,CAAxB;;AACA,QAAI,uBAAuB,CAAC,CAAxB,IAA6B,kBAAjC,EAAqD;AACpD,MAAA,uBAAuB,CAAC,CAAxB,GAA4B,CAA5B;AACA;;AACD,IAAA,KAAI,CAAC,CAAL,GAAS,uBAAuB,CAAC,CAAjC;;AACA;;AAdD,EAAA,MAAA,CAAA,cAAA,CAAI,uBAAA,CAAA,SAAJ,EAAI,GAAJ,EAAK;SAAL,YAAA;AACC,aAAO,KAAK,CAAZ;AACA,KAFI;oBAAA;;AAAA,GAAL;AAGA,EAAA,MAAA,CAAA,cAAA,CAAI,uBAAA,CAAA,SAAJ,EAAI,GAAJ,EAAK;SAAL,YAAA;AACC,aAAO,KAAK,CAAZ;AACA,KAFI;oBAAA;;AAAA,GAAL;;AAYA,EAAA,uBAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACC,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,UAAvB;AACA,QAAI,CAAC,GAAW,CAAhB;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,aAAvB;AACA,QAAI,CAAC,GAAmB,KAAK,CAAL,CAAO,MAA/B;AACA,SAAK,CAAL,GAAS,KAAK,CAAL,CAAO,CAAhB;AACA,SAAK,CAAL,GAAS,KAAK,CAAL,CAAO,CAAhB;AACA,SAAK,CAAL,GAAS,KAAK,CAAL,CAAO,CAAhB;;AACA,QAAI,KAAK,CAAL,CAAO,4BAAP,IAAuC,KAAK,CAAL,GAAS,CAApD,EAAuD;AACtD,UAAI,CAAC,GAAG,IAAI,CAAC,IAAL,CAAU,IAAI,CAAJ,GAAQ,IAAI,CAAtB,IAA2B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,KAAK,CAAL,GAAS,CAArB,CAAnC;AACA,MAAA,CAAC,GAAG,CAAC,GAAG,CAAR;AACA;;AACD,QAAI,CAAC,MAAM,CAAC,CAAD,CAAX,EAAgB;AACf,UAAI,CAAC,GAAG,CAAR,EAAW;AACV,QAAA,CAAC,GAAG,CAAJ;AACA;AACD;;AACD,QAAI,CAAC,GAAa,KAAK,CAAL,CAAO,OAAzB;AACA,QAAI,CAAC,GAAa,KAAK,CAAL,CAAO,OAAzB;AACA,QAAI,CAAC,GAAa,KAAK,CAAL,CAAO,MAAzB;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,OAAP,CAAe,MAA/B;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,OAAP,CAAe,MAA/B;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,uBAAvB;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,uBAAvB;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,sBAAvB;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,sBAAvB;AACA,QAAI,CAAC,GAAW,KAAK,CAAL,CAAO,KAAK,CAAL,CAAO,YAAd,EAA4B,CAA5B,CAAhB;AACA,QAAI,CAAC,GAAa,KAAK,CAAL,CAAO,CAAP,EAAU,CAAV,CAAlB;AACA,QAAI,CAAC,GAAW,IAAI,CAAC,GAAL,CAAS,CAAC,CAAC,CAAF,CAAI,CAAJ,EAAO,KAAK,CAAL,CAAO,MAAd,EAAsB,KAAK,CAAL,CAAO,YAA7B,IAA6C,CAAC,CAAC,CAAF,CAAI,CAAJ,EAAO,KAAK,CAAL,CAAO,MAAd,EAAsB,KAAK,CAAL,CAAO,YAA7B,CAAtD,CAAhB;AACA,QAAI,CAAC,GAAW,IAAI,CAAC,GAAL,CAAS,CAAC,CAAC,CAAF,CAAI,CAAJ,EAAO,KAAK,CAAL,CAAO,MAAd,EAAsB,KAAK,CAAL,CAAO,YAA7B,IAA6C,CAAC,CAAC,CAAF,CAAI,CAAJ,EAAO,KAAK,CAAL,CAAO,MAAd,EAAsB,KAAK,CAAL,CAAO,YAA7B,CAAtD,CAAhB;AACA,QAAI,CAAJ;AACA,QAAI,EAAJ;AACA,QAAI,EAAE,GAAmB,IAAI,MAAJ,CAAmB,YAAnB,EAAiC,CAAjC,CAAzB;AACA,QAAI,EAAE,GAAmB,IAAI,MAAJ,CAAmB,YAAnB,EAAiC,CAAjC,CAAzB;AACA,QAAI,EAAE,GAAmB,IAAI,MAAJ,CAAmB,YAAnB,EAAiC,CAAjC,CAAzB;;AACA,SAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,CAAtB,EAAyB,EAAE,EAA3B,EAA+B;AAC9B,MAAA,CAAC,GAAG,CAAC,CAAC,EAAD,CAAL;AACA,MAAA,CAAC,GAAG,CAAC,CAAC,EAAD,CAAL;AACA,MAAA,CAAC,GAAG,CAAC,CAAC,EAAD,CAAL;AACA,MAAA,CAAC,GAAG,CAAC,GAAG,CAAR;AACA,MAAA,CAAC,GAAG,CAAC,GAAG,CAAR;AACA,MAAA,CAAC,GAAG,CAAC,GAAG,CAAR;AACA,MAAA,CAAC,GAAG,CAAC,GAAG,CAAR;;AACA,UAAI,CAAC,GAAG,CAAJ,IAAS,CAAC,GAAG,CAAb,IAAkB,CAAC,GAAG,CAAtB,IAA2B,CAAC,GAAG,CAAnC,EAAsC;AACrC;AACA;;AACD,MAAA,EAAE,CAAC,GAAH,CAAO,CAAP;AACA,MAAA,EAAE,CAAC,GAAH,CAAO,CAAP;AACA,MAAA,EAAE,CAAC,GAAH,CAAO,CAAP;AACA;;AACD,QAAI,EAAE,GAAa,KAAK,CAAL,CAAO,KAAK,CAAL,CAAO,YAAd,CAAnB;AACA,QAAI,EAAE,GAAa,KAAK,CAAL,CAAO,KAAK,CAAL,CAAO,YAAd,CAAnB;AACA,QAAI,EAAE,GAAmB,QAAQ,CAAC,KAAK,CAAL,CAAO,YAAP,CAAoB,KAArB,CAAjC;AACA,QAAI,EAAE,GAAW,EAAE,CAAC,KAApB;AACA,IAAA,CAAC,CAAC,CAAF,CAAI,EAAJ,EAAQ,KAAK,CAAL,CAAO,MAAf,EAAuB,KAAK,CAAL,CAAO,YAA9B;AACA,IAAA,CAAC,CAAC,CAAF,CAAI,EAAJ,EAAQ,KAAK,CAAL,CAAO,MAAf,EAAuB,KAAK,CAAL,CAAO,YAA9B;AACA,QAAI,EAAJ;AACA,QAAI,EAAJ;AACA,QAAI,EAAJ;AACA,QAAI,EAAJ;;AACA,SAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,EAAtB,EAA0B,EAAE,EAA5B,EAAgC;AAC/B,MAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,CAAC,MAAH,CAAU,EAAV,IAAgB,CAA3B,CAAD,CAApB;AACA,MAAA,EAAE,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,CAAC,MAAH,CAAU,EAAV,IAAgB,CAA3B,CAAD,CAArB;;AACA,WAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,CAAC,GAAG,CAA1B,EAA6B,EAAE,EAA/B,EAAmC;AAClC,aAAK,IAAI,EAAE,GAAG,EAAd,EAAkB,EAAE,GAAG,EAAE,GAAG,CAA5B,EAA+B,EAAE,EAAjC,EAAqC;AACpC,UAAA,EAAE,GAAG,EAAE,GAAG,CAAV;AACA,UAAA,EAAE,GAAG,EAAE,GAAG,EAAV;;AACA,cAAI,EAAE,GAAG,CAAL,IAAU,EAAE,GAAI,EAAE,GAAG,CAArB,IAA2B,EAAE,GAAG,CAAhC,IAAqC,EAAE,GAAI,EAAE,GAAG,CAApD,EAAwD;AACvD;AACA;;AACD,UAAA,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAL,GAAS,EAAV,CAAN;AACA,UAAA,EAAE,GAAG,EAAE,CAAC,MAAH,CAAU,EAAV,IAAgB,EAArB;AACA,UAAA,EAAE,CAAC,EAAE,GAAG,EAAL,GAAU,EAAX,CAAF,GAAmB,EAAE,CAAC,EAAE,GAAG,EAAL,GAAU,EAAX,CAAF,GAAmB,EAAtC;AACA;AACD;AACD;;AACD,QAAI,EAAE,GAAW,EAAE,CAAC,MAApB;AACA,QAAI,EAAE,GAAW,CAAC,uBAAlB;AACA,QAAI,EAAE,GAAW,uBAAjB;AACA,QAAI,EAAJ;;AACA,QAAI,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,aAAR,CAAP,IAAiC,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,aAAR,CAAxC,IAAkE,KAAK,CAAL,CAAO,eAAzE,IAA4F,CAAC,KAAK,CAAL,CAAO,OAAxG,EAAiH;AAChH,MAAA,EAAE,GAAG,KAAK,CAAL,CAAO,aAAZ;AACA,MAAA,EAAE,GAAG,KAAK,CAAL,CAAO,aAAZ;;AACA,UAAI,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,YAAR,CAAX,EAAkC;AACjC,QAAA,EAAE,GAAG,KAAK,CAAL,CAAO,YAAZ;AACA;;AACD,UAAI,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,YAAR,CAAX,EAAkC;AACjC,QAAA,EAAE,GAAG,KAAK,CAAL,CAAO,YAAZ;AACA;AACD,KATD,MASO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,YAAR,CAAP,IAAgC,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,YAAR,CAA3C,EAAkE;AACxE,MAAA,EAAE,GAAG,KAAK,CAAL,CAAO,YAAZ;AACA,MAAA,EAAE,GAAG,KAAK,CAAL,CAAO,YAAZ;AACA,KAHM,MAGA;AACN,UAAI,EAAE,GAAW,CAAC,CAAlB;AACA,UAAI,EAAE,GAAW,CAAC,CAAlB;;AACA,WAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,EAAtB,EAA0B,EAAE,EAA5B,EAAgC;AAC/B,QAAA,EAAE,GAAG,EAAE,CAAC,EAAD,CAAP;;AACA,YAAI,EAAE,GAAG,CAAT,EAAY;AACX,cAAI,EAAE,GAAG,EAAT,EAAa;AACZ,YAAA,EAAE,GAAG,EAAL;AACA,YAAA,EAAE,GAAG,EAAL;AACA;;AACD,cAAI,EAAE,GAAG,EAAT,EAAa;AACZ,YAAA,EAAE,GAAG,EAAL;AACA,YAAA,EAAE,GAAG,EAAL;AACA;AACD;AACD;;AACD,UAAI,EAAE,GAAmB,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,GAAW,EAAxB,CAAD,CAAjC;AACA,UAAI,EAAE,GAAW,EAAE,GAAG,EAAtB;AACA,UAAI,EAAE,GAAmB,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,GAAW,EAAxB,CAAD,CAAjC;AACA,UAAI,EAAE,GAAW,EAAE,GAAG,EAAtB;AACA,WAAK,CAAL,CAAO,aAAP,GAAuB,EAAvB;AACA,WAAK,CAAL,CAAO,aAAP,GAAuB,EAAvB;AACA,UAAI,EAAE,GAAW,CAAjB;AACA,UAAI,EAAE,GAAW,CAAjB;AACA,UAAI,EAAE,GAAW,CAAjB;AACA,UAAI,EAAE,GAAW,CAAjB;AACA,UAAI,EAAE,GAAW,CAAjB;AACA,UAAI,EAAE,GAAW,CAAjB;;AACA,WAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,EAAtB,EAA0B,EAAE,EAA5B,EAAgC;AAC/B,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,CAAC,MAAH,CAAU,EAAV,IAAgB,CAA3B,CAAD,CAApB;AACA,QAAA,EAAE,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,CAAC,MAAH,CAAU,EAAV,IAAgB,CAA3B,CAAD,CAArB;;AACA,aAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,CAAC,GAAG,CAA1B,EAA6B,EAAE,EAA/B,EAAmC;AAClC,eAAK,IAAI,EAAE,GAAG,EAAd,EAAkB,EAAE,GAAG,EAAE,GAAG,CAA5B,EAA+B,EAAE,EAAjC,EAAqC;AACpC,YAAA,EAAE,GAAG,EAAE,GAAG,CAAV;AACA,YAAA,EAAE,GAAG,EAAE,GAAG,EAAV;;AACA,gBAAI,EAAE,GAAG,CAAL,IAAU,EAAE,GAAI,EAAE,GAAG,CAArB,IAA2B,EAAE,GAAG,CAAhC,IAAqC,EAAE,GAAI,EAAE,GAAG,CAApD,EAAwD;AACvD;AACA;;AACD,gBAAI,EAAE,IAAI,EAAN,IAAY,EAAE,IAAI,EAAtB,EAA0B;AACzB,cAAA,EAAE;AACF,cAAA,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAF,CAAI,EAAE,CAAC,MAAH,CAAU,EAAV,CAAJ,EAAmB,KAAK,CAAL,CAAO,MAA1B,EAAkC,KAAK,CAAL,CAAO,YAAzC,CAAV;AACA,cAAA,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAF,CAAI,EAAE,CAAC,MAAH,CAAU,EAAV,CAAJ,EAAmB,KAAK,CAAL,CAAO,MAA1B,EAAkC,KAAK,CAAL,CAAO,YAAzC,CAAV;AACA;;AACD,gBAAI,EAAE,IAAI,EAAN,IAAY,EAAE,IAAI,EAAtB,EAA0B;AACzB,cAAA,EAAE;AACF,cAAA,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAF,CAAI,EAAE,CAAC,MAAH,CAAU,EAAV,CAAJ,EAAmB,KAAK,CAAL,CAAO,MAA1B,EAAkC,KAAK,CAAL,CAAO,YAAzC,CAAV;AACA,cAAA,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAF,CAAI,EAAE,CAAC,MAAH,CAAU,EAAV,CAAJ,EAAmB,KAAK,CAAL,CAAO,MAA1B,EAAkC,KAAK,CAAL,CAAO,YAAzC,CAAV;AACA;AACD;AACD;AACD;;AACD,WAAK,CAAL,GAAS,EAAE,GAAG,EAAd;AACA,WAAK,CAAL,GAAS,EAAE,GAAG,EAAd;AACA,WAAK,CAAL,GAAS,EAAE,GAAG,EAAd;AACA,WAAK,CAAL,GAAS,EAAE,GAAG,EAAd;;AACA,UAAI,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,YAAR,CAAX,EAAkC;AACjC,QAAA,EAAE,GAAG,KAAK,CAAL,CAAO,YAAZ;AACA;;AACD,UAAI,CAAC,MAAM,CAAC,KAAK,CAAL,CAAO,YAAR,CAAX,EAAkC;AACjC,QAAA,EAAE,GAAG,KAAK,CAAL,CAAO,YAAZ;AACA;AACD;;AACD,QAAI,CAAC,KAAK,CAAL,CAAO,OAAZ,EAAqB;AACpB,WAAK,CAAL,CAAO,EAAP,EAAW,EAAX,EAAe,EAAf,EAAmB,EAAnB;AACA,WAAK,CAAL,GAAS,EAAT;AACA;;AACD,SAAK,CAAL;AACA,GAtKD;;AAuKQ,EAAA,uBAAA,CAAA,SAAA,CAAA,CAAA,GAAR,UAAU,CAAV,EAAuB,CAAvB,EAAoC,CAApC,EAA+C,CAA/C,EAAwD;AACvD,QAAI,CAAJ;AACA,QAAI,CAAC,GAAW,CAAC,CAAC,MAAlB;;AACA,QAAI,KAAK,CAAL,CAAO,mBAAX,EAAgC;AAC/B,UAAI,CAAC,IAAI,CAAT,EAAY;AACX,QAAA,CAAC,GAAG,CAAJ;AACA,OAFD,MAEO;AACN,QAAA,CAAC,GAAG,OAAO,CAAC,CAAD,EAAI,KAAK,CAAL,CAAO,aAAX,CAAX;AACA;;AACD,UAAI,CAAC,IAAI,CAAT,EAAY;AACX,QAAA,CAAC,GAAG,CAAJ;AACA,OAFD,MAEO;AACN,QAAA,CAAC,GAAG,OAAO,CAAC,CAAD,EAAI,KAAK,CAAL,CAAO,aAAX,CAAX;AACA;AACD;;AACD,QAAI,CAAC,GAAW,CAAhB;AACA,QAAI,CAAC,GAAW,CAAC,GAAG,CAApB;;AACA,QAAI,MAAM,CAAC,CAAD,CAAN,IAAa,CAAC,IAAI,CAAtB,EAAyB;AACxB,MAAA,CAAC,GAAG,CAAJ;AACA;;AACD,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAJ;AACA,QAAI,CAAC,GAAG,KAAK,CAAL,CAAO,mBAAf;AACA,QAAI,CAAC,GAAG,KAAK,CAAL,CAAO,aAAf;;AACA,QAAI,KAAK,CAAL,CAAO,WAAP,IAAsB,IAA1B,EAAgC;AAC/B,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,CAAC,GAAuB,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAA5B;AACA,UAAI,EAAE,GAAa,KAAK,CAAL,CAAO,iBAA1B;;AACA,UAAI,EAAE,IAAI,IAAN,IAAc,EAAE,CAAC,MAAH,IAAa,KAAK,CAAL,CAAO,WAAP,CAAmB,MAAlD,EAA0D;AACzD,QAAA,EAAE,GAAa,IAAI,KAAJ,CAAU,KAAK,CAAL,CAAO,WAAP,CAAmB,MAA7B,CAAf;;AACA,YAAI,EAAE,CAAC,MAAH,IAAa,CAAjB,EAAoB;AACnB,UAAA,EAAE,CAAC,CAAD,CAAF,GAAQ,CAAR;AACA,SAFD,MAEO;AACN,eAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,KAAK,CAAL,CAAO,WAAP,CAAmB,MAAzC,EAAiD,EAAE,EAAnD,EAAuD;AACtD,YAAA,EAAE,CAAC,EAAD,CAAF,GAAiB,EAAE,IAAY,KAAK,CAAL,CAAO,WAAP,CAAmB,MAAnB,GAA4B,CAAxC,CAAnB;AACA;AACD;AACD;;AACD,WAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,KAAK,CAAL,CAAO,WAAP,CAAmB,MAAzC,EAAiD,EAAE,EAAnD,EAAuD;AACtD,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;AACA,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;AACA,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;AACA,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;;AACA,YAAI,EAAE,GAAG,KAAK,CAAL,CAAO,WAAP,CAAmB,MAAnB,GAA4B,CAArC,EAAwC;AACvC,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAE,GAAG,CAAxB,EAA2B,CAAnC;AACA,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAE,GAAG,CAAxB,EAA2B,CAAnC;AACA,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAE,GAAG,CAAxB,EAA2B,CAAnC;AACA,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAE,GAAG,CAAxB,EAA2B,CAAnC;AACA,SALD,MAKO;AACN,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;AACA,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;AACA,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;AACA,UAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,KAAK,CAAL,CAAO,WAAP,CAAmB,EAAnB,EAAuB,CAA/B;AACA;;AACD,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAjB;AACA,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAjB;AACA,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAjB;AACA,QAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,CAAC,EAAD,CAAjB;AACA;;AACD,WAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,CAAtB,EAAyB,EAAE,EAA3B,EAA+B;AAC9B,QAAA,CAAC,GAAG,CAAC,CAAC,EAAD,CAAL;;AACA,YAAI,CAAC,IAAI,CAAT,EAAY;AACX;AACA;;AACD,YAAI,CAAJ,EAAO;AACN,cAAI,CAAC,IAAI,CAAT,EAAY;AACX,YAAA,CAAC,GAAG,CAAJ;AACA,WAFD,MAEO;AACN,YAAA,CAAC,GAAG,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAX;AACA;AACD;;AACD,QAAA,CAAC,GAAG,CAAC,CAAC,GAAG,CAAL,IAAW,CAAf;;AACA,YAAI,CAAC,GAAG,CAAR,EAAW;AACV,UAAA,CAAC,GAAG,CAAJ;AACA;;AACD,YAAI,CAAC,GAAG,CAAR,EAAW;AACV,UAAA,CAAC,GAAG,CAAJ;AACA;;AACD,YAAI,EAAE,GAAW,CAAjB;;AACA,aAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,EAAE,CAAC,MAAzB,EAAiC,EAAE,EAAnC,EAAuC;AACtC,cAAI,EAAE,CAAC,EAAD,CAAF,IAAU,CAAd,EAAiB;AAChB,YAAA,EAAE,GAAG,EAAE,GAAG,CAAV;AACA;AACA;AACD;;AACD,YAAI,EAAE,GAAG,EAAE,CAAC,MAAH,GAAY,CAArB,EAAwB;AACvB,UAAA,EAAE,GAAG,EAAE,CAAC,MAAH,GAAY,CAAjB;AACA;;AACD,YAAI,EAAE,GAAG,CAAT,EAAY;AACX,UAAA,EAAE,GAAG,CAAL;AACA;;AACD,QAAA,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,EAAD,CAAP,KAAgB,EAAE,CAAC,EAAE,GAAG,CAAN,CAAF,GAAa,EAAE,CAAC,EAAD,CAA/B,CAAJ;AACA,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,GAAI,CAAC,CAAC,EAAD,CAAzB,CAAD,CAApB;AACA,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,GAAI,CAAC,CAAC,EAAD,CAAzB,CAAD,CAApB;AACA,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,GAAI,CAAC,CAAC,EAAD,CAAzB,CAAD,CAApB;AACA,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,CAAC,CAAC,EAAD,CAAD,GAAQ,CAAC,GAAI,CAAC,CAAC,EAAD,CAAzB,CAAD,CAApB;AACA,QAAA,CAAC,CAAC,IAAI,EAAL,CAAD,GAAY,CAAZ;AACA,QAAA,CAAC,CAAC,IAAI,EAAJ,GAAS,CAAV,CAAD,GAAgB,CAAhB;AACA,QAAA,CAAC,CAAC,IAAI,EAAJ,GAAS,CAAV,CAAD,GAAgB,CAAhB;AACA,QAAA,CAAC,CAAC,IAAI,EAAJ,GAAS,CAAV,CAAD,GAAgB,CAAhB;AACA;AACD,KAvFD,MAuFO;AACN,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,KAAK,CAAL,CAAO,YAAP,CAAoB,CAArC;AACA,UAAI,EAAE,GAAW,EAAE,GAAG,EAAtB;AACA,UAAI,EAAE,GAAW,EAAE,GAAG,EAAtB;AACA,UAAI,EAAE,GAAW,EAAE,GAAG,EAAtB;AACA,UAAI,EAAE,GAAW,EAAE,GAAG,EAAtB;;AACA,WAAK,IAAI,EAAE,GAAG,CAAd,EAAiB,EAAE,GAAG,CAAtB,EAAyB,EAAE,EAA3B,EAA+B;AAC9B,QAAA,CAAC,GAAG,CAAC,CAAC,EAAD,CAAL;;AACA,YAAI,CAAC,IAAI,CAAT,EAAY;AACX;AACA;;AACD,YAAI,CAAJ,EAAO;AACN,UAAA,CAAC,GAAG,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAX;AACA;;AACD,QAAA,CAAC,GAAG,CAAC,CAAC,GAAG,CAAL,IAAW,CAAf;;AACA,YAAI,CAAC,GAAG,CAAR,EAAW;AACV,UAAA,CAAC,GAAG,CAAJ;AACA;;AACD,YAAI,CAAC,GAAG,CAAR,EAAW;AACV,UAAA,CAAC,GAAG,CAAJ;AACA;;AACD,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,GAAG,CAAC,GAAI,EAArB,CAAD,CAApB;AACA,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,GAAG,CAAC,GAAI,EAArB,CAAD,CAApB;AACA,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,GAAG,CAAC,GAAI,EAArB,CAAD,CAApB;AACA,QAAA,CAAC,GAAW,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,EAAE,GAAG,CAAC,GAAI,EAArB,CAAD,CAApB;AACA,QAAA,CAAC,CAAC,IAAI,EAAL,CAAD,GAAY,CAAZ;AACA,QAAA,CAAC,CAAC,IAAI,EAAJ,GAAS,CAAV,CAAD,GAAgB,CAAhB;AACA,QAAA,CAAC,CAAC,IAAI,EAAJ,GAAS,CAAV,CAAD,GAAgB,CAAhB;AACA,QAAA,CAAC,CAAC,IAAI,EAAJ,GAAS,CAAV,CAAD,GAAgB,CAAhB;AACA;AACD;AACD,GAvJO;;AAwJA,EAAA,uBAAA,CAAA,SAAA,CAAA,CAAA,GAAR,UAAU,CAAV,EAAiB;AAChB,QAAI,CAAC,GAAa,IAAI,KAAJ,CAAkB,QAAQ,CAAC,CAAC,CAAC,KAAH,CAAR,GAA4B,QAAQ,CAAC,CAAC,CAAC,MAAH,CAAtD,CAAlB;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAAC,CAAC,MAAtB,EAA8B,CAAC,EAA/B,EAAmC;AAClC,MAAA,CAAC,CAAC,CAAD,CAAD,GAAO,CAAP;AACA;;AACD,WAAO,CAAP;AACA,GANO;;AAOA,EAAA,uBAAA,CAAA,SAAA,CAAA,CAAA,GAAR,UAAU,CAAV,EAAiB;AAChB,QAAI,CAAC,GAAa,IAAI,KAAJ,CAAkB,QAAQ,CAAC,CAAC,CAAC,KAAH,CAAR,GAA4B,QAAQ,CAAC,CAAC,CAAC,MAAH,CAApC,GAAiD,CAAnE,CAAlB;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAAC,CAAC,MAAtB,EAA8B,CAAC,EAA/B,EAAmC;AAClC,MAAA,CAAC,CAAC,CAAD,CAAD,GAAO,CAAP;AACA;;AACD,WAAO,CAAP;AACA,GANO;;AAOA,EAAA,uBAAA,CAAA,SAAA,CAAA,CAAA,GAAR,UAAU,CAAV,EAAqB,CAArB,EAA8B;AAC7B,QAAI,CAAC,GAAa,IAAI,KAAJ,CAAkB,CAAC,GAAW,CAA9B,CAAlB;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAAC,CAAC,MAAtB,EAA8B,CAAC,EAA/B,EAAmC;AAClC,MAAA,CAAC,CAAC,CAAD,CAAD,GAAO,CAAP;AACA;;AACD,QAAI,CAAC,GAAG,CAAC,GAAG,CAAZ;AACA,QAAI,CAAC,GAAG,CAAC,GAAG,CAAZ;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAApB,EAAuB,CAAC,EAAxB,EAA4B;AAC3B,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAApB,EAAuB,CAAC,EAAxB,EAA4B;AAC3B,YAAI,CAAC,GAAG,IAAI,CAAC,IAAL,CAAU,IAAI,CAAC,GAAL,CAAS,CAAC,GAAG,CAAb,EAAgB,CAAhB,IAAqB,IAAI,CAAC,GAAL,CAAS,CAAC,GAAG,CAAb,EAAgB,CAAhB,CAA/B,CAAR;;AACA,YAAI,CAAC,GAAG,CAAR,EAAW;AACV,UAAA,CAAC,CAAC,CAAC,GAAG,CAAJ,GAAQ,CAAT,CAAD,GAAe,CAAf;AACA,SAFD,MAEO;AACN,UAAA,CAAC,CAAC,CAAC,GAAG,CAAJ,GAAQ,CAAT,CAAD,GAAe,CAAC,GAAG,CAAnB;AACA;AACD;AACD;;AACD,QAAI,CAAC,GAAW,CAAhB;AACA,QAAI,CAAC,GAAW,CAAC,uBAAjB;AACA,QAAI,CAAC,GAAW,uBAAhB;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAApB,EAAuB,CAAC,EAAxB,EAA4B;AAC3B,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAApB,EAAuB,CAAC,EAAxB,EAA4B;AAC3B,YAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAJ,GAAQ,CAAT,CAAT;;AACA,YAAI,CAAC,IAAI,CAAT,EAAY;AACX;AACA;;AACD,QAAA,CAAC,IAAI,CAAL;AACA,QAAA,CAAC,GAAG,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAY,CAAhB;AACA,QAAA,CAAC,GAAG,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAY,CAAhB;AACA;AACD;;AACD,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAApB,EAAuB,CAAC,EAAxB,EAA4B;AAC3B,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAApB,EAAuB,CAAC,EAAxB,EAA4B;AAC3B,YAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAJ,GAAQ,CAAT,CAAT;;AACA,YAAI,CAAC,IAAI,CAAT,EAAY;AACX;AACA;;AACD,YAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAL,KAAW,CAAC,GAAG,CAAf,CAAR;AACA,QAAA,CAAC,CAAC,CAAC,GAAG,CAAJ,GAAQ,CAAT,CAAD,GAAe,OAAO,CAAC,GAAI,IAA3B;AACA;AACD;;AACD,IAAA,CAAC,CAAS,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAd,GAA0B,QAAQ,CAAC,CAAD,CAA3C,CAAD,GAAmD,CAAnD;AACA,WAAO,CAAP;AACA,GA3CO;;AA4CA,EAAA,uBAAA,CAAA,SAAA,CAAA,CAAA,GAAR,UAAU,CAAV,EAAmB,CAAnB,EAA4B;AAC3B,WAAe,QAAQ,CAAC,IAAI,CAAC,KAAL,CAAW,CAAC,GAAG,CAAf,CAAD,CAAvB;AACA,GAFO;;AAGA,EAAA,uBAAA,CAAA,SAAA,CAAA,CAAA,GAAR,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACC,QAAI,KAAK,aAAL,IAAsB,IAA1B,EAAgC;AAC/B;AACA;;AACD,SAAK,aAAL,CAAmB,WAAnB,CAAiC,YAAA;AAChC,UAAI,IAAI,GAAG,IAAI,6BAAJ,EAAX;AACA,MAAA,IAAI,CAAC,GAAL,GAAW,KAAI,CAAC,CAAhB;AACA,MAAA,IAAI,CAAC,CAAL,GAAS,KAAI,CAAC,CAAd;AACA,MAAA,IAAI,CAAC,CAAL,GAAS,KAAI,CAAC,CAAd;AACA,MAAA,IAAI,CAAC,CAAL,GAAS,KAAI,CAAC,CAAd;AACA,MAAA,IAAI,CAAC,kBAAL,GAA0B,KAAI,CAAC,CAAL,CAAO,aAAjC;AACA,MAAA,IAAI,CAAC,kBAAL,GAA0B,KAAI,CAAC,CAAL,CAAO,aAAjC;AACA,MAAA,IAAI,CAAC,2BAAL,GAAmC,KAAI,CAAC,CAAxC;AACA,MAAA,IAAI,CAAC,0BAAL,GAAkC,KAAI,CAAC,CAAvC;AACA,MAAA,IAAI,CAAC,2BAAL,GAAmC,KAAI,CAAC,CAAxC;AACA,MAAA,IAAI,CAAC,0BAAL,GAAkC,KAAI,CAAC,CAAvC;AACA,MAAA,IAAI,CAAC,SAAL,GAAiB,KAAI,CAAC,CAAtB;AACA,MAAA,IAAI,CAAC,KAAL,GAAa,KAAI,CAAC,CAAL,CAAO,KAApB;AACA,aAAO,IAAP;AACA,KAf+B,EAAhC;AAgBA,GApBO;;AA2BR,EAAA,MAAA,CAAA,cAAA,CAAI,uBAAA,CAAA,SAAJ,EAAI,eAAJ,EAAiB;SAAjB,YAAA;AACC,aAAO,KAAK,cAAZ;AACA,KAFgB;SAGjB,UAAkB,CAAlB,EAA2C;AAC1C,WAAK,cAAL,GAAsB,CAAtB;AACA,KALgB;oBAAA;;AAAA,GAAjB;AAlbO,EAAA,uBAAA,CAAA,EAAA,GAAW,QAAQ,CAAC,uBAAD,EAA0B,yBAA1B,CAAnB;AAOQ,EAAA,uBAAA,CAAA,CAAA,GAAS,EAAT;AACA,EAAA,uBAAA,CAAA,CAAA,GAAY,CAAZ;AAoaA,EAAA,uBAAA,CAAA,CAAA,GAAY,CAAZ;AAYhB,SAAA,uBAAA;AAAC,CAzbD,CAA6C,IAA7C,CAAA;;SAAa,uB","sourceRoot":"","sourcesContent":["/*\nTHIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT (\"AGREEMENT\") LOCATED HERE:\nhttps://www.infragistics.com/legal/license/igultimate-la\nhttps://www.infragistics.com/legal/license/igultimate-eula\nGOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.\n*/\nimport * as tslib_1 from \"tslib\";\nimport { Base, Number_$type, markType } from \"./type\";\nimport { List$1 } from \"./List$1\";\nimport { HeatTileImageCreatedEventArgs } from \"./HeatTileImageCreatedEventArgs\";\nimport { truncate, isNaN_, logBase } from \"./number\";\n/**\n * @hidden\n */\nvar HeatTileGeneratorWorker = /** @class */ /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(HeatTileGeneratorWorker, _super);\n    function HeatTileGeneratorWorker(a) {\n        var _this = _super.call(this) || this;\n        _this.f = null;\n        _this.a = null;\n        _this.n = 0;\n        _this.o = 0;\n        _this.p = 0;\n        _this.w = null;\n        _this.u = 0;\n        _this.h = false;\n        _this.r = 0;\n        _this.i = 0;\n        _this.j = 0;\n        _this.k = 0;\n        _this.l = 0;\n        _this._completedSink = null;\n        _this.f = a;\n        HeatTileGeneratorWorker.s++;\n        if (HeatTileGeneratorWorker.s == 0x7FFFFFFFFFFFFFFF) {\n            HeatTileGeneratorWorker.s = 0;\n        }\n        _this.r = HeatTileGeneratorWorker.s;\n        return _this;\n    }\n    Object.defineProperty(HeatTileGeneratorWorker.prototype, \"t\", {\n        get: function () {\n            return this.r;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeatTileGeneratorWorker.prototype, \"g\", {\n        get: function () {\n            return this.f;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HeatTileGeneratorWorker.prototype.doWork = function () {\n        var a = this.g.blurRadius;\n        var b = a;\n        var c = this.g.maxBlurRadius;\n        var d = this.g.scaler;\n        this.n = this.g.x;\n        this.o = this.g.y;\n        this.p = this.g.z;\n        if (this.g.useBlurRadiusAdjustedForZoom && this.p > 0) {\n            var e = Math.sqrt(1 * 1 + 1 * 1) * Math.pow(2, this.p - 1);\n            b = a * e;\n        }\n        if (!isNaN_(c)) {\n            if (b > c) {\n                b = c;\n            }\n        }\n        var f = this.g.xValues;\n        var g = this.g.yValues;\n        var h = this.g.values;\n        var i = this.g.xValues.length;\n        var j = this.g.yValues.length;\n        var k;\n        var l;\n        var m;\n        var n;\n        var o;\n        var p;\n        var q;\n        var r = this.g.minimumVisibleLongitude;\n        var s = this.g.maximumVisibleLongitude;\n        var t = this.g.minimumVisibleLatitude;\n        var u = this.g.maximumVisibleLatitude;\n        var v = this.q(this.g.tileViewport, b);\n        var w = this.c(v, b);\n        var x = Math.abs(d.t(0, this.g.window, this.g.tileViewport) - d.t(b, this.g.window, this.g.tileViewport));\n        var y = Math.abs(d.u(0, this.g.window, this.g.tileViewport) - d.u(b, this.g.window, this.g.tileViewport));\n        var z;\n        var aa;\n        var ab = new List$1(Number_$type, 0);\n        var ac = new List$1(Number_$type, 0);\n        var ad = new List$1(Number_$type, 0);\n        for (var ae = 0; ae < i; ae++) {\n            k = f[ae];\n            l = g[ae];\n            m = h[ae];\n            n = k - y;\n            o = k + y;\n            p = l - x;\n            q = l + x;\n            if (o < r || q < t || p > u || n > s) {\n                continue;\n            }\n            ab.add(k);\n            ac.add(l);\n            ad.add(m);\n        }\n        var af = this.d(this.g.tileViewport);\n        var ag = this.b(this.g.tileViewport);\n        var ah = truncate(this.g.tileViewport.width);\n        var ai = ac.count;\n        d.v(ac, this.g.window, this.g.tileViewport);\n        d.w(ab, this.g.window, this.g.tileViewport);\n        var aj;\n        var ak;\n        var al;\n        var am;\n        for (var an = 0; an < ai; an++) {\n            z = truncate(Math.floor(ab._inner[an] - b));\n            aa = truncate(Math.floor(ac._inner[an] - b));\n            for (var ao = z; ao < z + v; ao++) {\n                for (var ap = aa; ap < aa + v; ap++) {\n                    aj = ao - z;\n                    ak = ap - aa;\n                    if (ao < 0 || ao > (ah - 1) || ap < 0 || ap > (ah - 1)) {\n                        continue;\n                    }\n                    al = w[ak * v + aj];\n                    am = ad._inner[an] * al;\n                    ag[ap * ah + ao] = ag[ap * ah + ao] + am;\n                }\n            }\n        }\n        var aq = ag.length;\n        var ar = -1.7976931348623157E+308;\n        var as = 1.7976931348623157E+308;\n        var at;\n        if (!isNaN_(this.g.globalMinimum) && !isNaN_(this.g.globalMaximum) && this.g.useGlobalMinMax && !this.g.testRun) {\n            as = this.g.globalMinimum;\n            ar = this.g.globalMaximum;\n            if (!isNaN_(this.g.minimumValue)) {\n                as = this.g.minimumValue;\n            }\n            if (!isNaN_(this.g.maximumValue)) {\n                ar = this.g.maximumValue;\n            }\n        }\n        else if (!isNaN_(this.g.minimumValue) && !isNaN_(this.g.maximumValue)) {\n            as = this.g.minimumValue;\n            ar = this.g.maximumValue;\n        }\n        else {\n            var au = -1;\n            var av = -1;\n            for (var aw = 0; aw < aq; aw++) {\n                at = ag[aw];\n                if (at > 0) {\n                    if (at > ar) {\n                        ar = at;\n                        au = aw;\n                    }\n                    if (at < as) {\n                        as = at;\n                        av = aw;\n                    }\n                }\n            }\n            var ax = truncate(Math.floor(au / ah));\n            var ay = au % ah;\n            var az = truncate(Math.floor(av / ah));\n            var a0 = av % ah;\n            this.g.globalMinimum = as;\n            this.g.globalMaximum = ar;\n            var a1 = 0;\n            var a2 = 0;\n            var a3 = 0;\n            var a4 = 0;\n            var a5 = 0;\n            var a6 = 0;\n            for (var a7 = 0; a7 < ai; a7++) {\n                z = truncate(Math.floor(ab._inner[a7] - b));\n                aa = truncate(Math.floor(ac._inner[a7] - b));\n                for (var a8 = z; a8 < z + v; a8++) {\n                    for (var a9 = aa; a9 < aa + v; a9++) {\n                        aj = a8 - z;\n                        ak = a9 - aa;\n                        if (a8 < 0 || a8 > (ah - 1) || a9 < 0 || a9 > (ah - 1)) {\n                            continue;\n                        }\n                        if (a8 == ay && a9 == ax) {\n                            a1++;\n                            a3 = a3 + d.t(ac._inner[a7], this.g.window, this.g.tileViewport);\n                            a4 = a4 + d.u(ab._inner[a7], this.g.window, this.g.tileViewport);\n                        }\n                        if (a8 == a0 && a9 == az) {\n                            a2++;\n                            a5 = a5 + d.t(ac._inner[a7], this.g.window, this.g.tileViewport);\n                            a6 = a6 + d.u(ab._inner[a7], this.g.window, this.g.tileViewport);\n                        }\n                    }\n                }\n            }\n            this.i = a3 / a1;\n            this.j = a4 / a1;\n            this.k = a5 / a2;\n            this.l = a6 / a2;\n            if (!isNaN_(this.g.minimumValue)) {\n                as = this.g.minimumValue;\n            }\n            if (!isNaN_(this.g.maximumValue)) {\n                ar = this.g.maximumValue;\n            }\n        }\n        if (!this.g.testRun) {\n            this.x(af, ag, ar, as);\n            this.a = af;\n        }\n        this.z();\n    };\n    HeatTileGeneratorWorker.prototype.x = function (a, b, c, d) {\n        var e;\n        var f = b.length;\n        if (this.g.useLogarithmicScale) {\n            if (d <= 0) {\n                d = 0;\n            }\n            else {\n                d = logBase(d, this.g.logarithmBase);\n            }\n            if (c <= 0) {\n                c = 0;\n            }\n            else {\n                c = logBase(c, this.g.logarithmBase);\n            }\n        }\n        var g = 0;\n        var h = c - d;\n        if (isNaN_(h) || h <= 0) {\n            h = 1;\n        }\n        var i;\n        var j;\n        var k;\n        var l;\n        var m = this.g.useLogarithmicScale;\n        var n = this.g.logarithmBase;\n        if (this.g.scaleColors != null) {\n            var o = new Array(this.g.scaleColors.length);\n            var p = new Array(this.g.scaleColors.length);\n            var q = new Array(this.g.scaleColors.length);\n            var r = new Array(this.g.scaleColors.length);\n            var s = new Array(this.g.scaleColors.length);\n            var t = new Array(this.g.scaleColors.length);\n            var u = new Array(this.g.scaleColors.length);\n            var v = new Array(this.g.scaleColors.length);\n            var w = new Array(this.g.scaleColors.length);\n            var x = new Array(this.g.scaleColors.length);\n            var y = new Array(this.g.scaleColors.length);\n            var z = new Array(this.g.scaleColors.length);\n            var aa = this.g.scaleColorOffsets;\n            if (aa == null || aa.length != this.g.scaleColors.length) {\n                aa = new Array(this.g.scaleColors.length);\n                if (aa.length == 1) {\n                    aa[0] = 0;\n                }\n                else {\n                    for (var ab = 0; ab < this.g.scaleColors.length; ab++) {\n                        aa[ab] = ab / (this.g.scaleColors.length - 1);\n                    }\n                }\n            }\n            for (var ac = 0; ac < this.g.scaleColors.length; ac++) {\n                o[ac] = this.g.scaleColors[ac].l;\n                q[ac] = this.g.scaleColors[ac].o;\n                s[ac] = this.g.scaleColors[ac].n;\n                u[ac] = this.g.scaleColors[ac].m;\n                if (ac < this.g.scaleColors.length - 1) {\n                    p[ac] = this.g.scaleColors[ac + 1].l;\n                    r[ac] = this.g.scaleColors[ac + 1].o;\n                    t[ac] = this.g.scaleColors[ac + 1].n;\n                    v[ac] = this.g.scaleColors[ac + 1].m;\n                }\n                else {\n                    p[ac] = this.g.scaleColors[ac].l;\n                    r[ac] = this.g.scaleColors[ac].o;\n                    t[ac] = this.g.scaleColors[ac].n;\n                    v[ac] = this.g.scaleColors[ac].m;\n                }\n                w[ac] = p[ac] - o[ac];\n                x[ac] = r[ac] - q[ac];\n                y[ac] = t[ac] - s[ac];\n                z[ac] = v[ac] - u[ac];\n            }\n            for (var ad = 0; ad < f; ad++) {\n                e = b[ad];\n                if (e == 0) {\n                    continue;\n                }\n                if (m) {\n                    if (e <= 0) {\n                        e = 0;\n                    }\n                    else {\n                        e = logBase(e, n);\n                    }\n                }\n                g = (e - d) / (h);\n                if (g < 0) {\n                    g = 0;\n                }\n                if (g > 1) {\n                    g = 1;\n                }\n                var ae = 0;\n                for (var af = 0; af < aa.length; af++) {\n                    if (aa[af] >= g) {\n                        ae = af - 1;\n                        break;\n                    }\n                }\n                if (ae > aa.length - 2) {\n                    ae = aa.length - 2;\n                }\n                if (ae < 0) {\n                    ae = 0;\n                }\n                g = (g - aa[ae]) / (aa[ae + 1] - aa[ae]);\n                i = truncate(Math.floor(o[ae] + g * (w[ae])));\n                j = truncate(Math.floor(q[ae] + g * (x[ae])));\n                k = truncate(Math.floor(s[ae] + g * (y[ae])));\n                l = truncate(Math.floor(u[ae] + g * (z[ae])));\n                a[4 * ad] = i;\n                a[4 * ad + 1] = j;\n                a[4 * ad + 2] = k;\n                a[4 * ad + 3] = l;\n            }\n        }\n        else {\n            var ag = this.g.minimumColor.l;\n            var ah = this.g.maximumColor.l;\n            var ai = this.g.minimumColor.o;\n            var aj = this.g.maximumColor.o;\n            var ak = this.g.minimumColor.n;\n            var al = this.g.maximumColor.n;\n            var am = this.g.minimumColor.m;\n            var an = this.g.maximumColor.m;\n            var ao = ah - ag;\n            var ap = aj - ai;\n            var aq = al - ak;\n            var ar = an - am;\n            for (var as = 0; as < f; as++) {\n                e = b[as];\n                if (e == 0) {\n                    continue;\n                }\n                if (m) {\n                    e = logBase(e, n);\n                }\n                g = (e - d) / (h);\n                if (g < 0) {\n                    g = 0;\n                }\n                if (g > 1) {\n                    g = 1;\n                }\n                i = truncate(Math.floor(ag + g * (ao)));\n                j = truncate(Math.floor(ai + g * (ap)));\n                k = truncate(Math.floor(ak + g * (aq)));\n                l = truncate(Math.floor(am + g * (ar)));\n                a[4 * as] = i;\n                a[4 * as + 1] = j;\n                a[4 * as + 2] = k;\n                a[4 * as + 3] = l;\n            }\n        }\n    };\n    HeatTileGeneratorWorker.prototype.b = function (a) {\n        var b = new Array(truncate(a.width) * truncate(a.height));\n        for (var c = 0; c < b.length; c++) {\n            b[c] = 0;\n        }\n        return b;\n    };\n    HeatTileGeneratorWorker.prototype.d = function (a) {\n        var b = new Array(truncate(a.width) * truncate(a.height) * 4);\n        for (var c = 0; c < b.length; c++) {\n            b[c] = 0;\n        }\n        return b;\n    };\n    HeatTileGeneratorWorker.prototype.c = function (a, b) {\n        var c = new Array(a * a);\n        for (var d = 0; d < c.length; d++) {\n            c[d] = 0;\n        }\n        var e = a / 2;\n        var f = a / 2;\n        for (var g = 0; g < a; g++) {\n            for (var h = 0; h < a; h++) {\n                var i = Math.sqrt(Math.pow(g - f, 2) + Math.pow(h - f, 2));\n                if (i > e) {\n                    c[h * a + g] = 0;\n                }\n                else {\n                    c[h * a + g] = e - i;\n                }\n            }\n        }\n        var j = 0;\n        var k = -1.7976931348623157E+308;\n        var l = 1.7976931348623157E+308;\n        for (var m = 0; m < a; m++) {\n            for (var n = 0; n < a; n++) {\n                var o = c[n * a + m];\n                if (o == 0) {\n                    continue;\n                }\n                j += o;\n                k = o > k ? o : k;\n                l = o < l ? o : l;\n            }\n        }\n        for (var p = 0; p < a; p++) {\n            for (var q = 0; q < a; q++) {\n                var r = c[q * a + p];\n                if (r == 0) {\n                    continue;\n                }\n                var s = (r - l) / (k - l);\n                c[q * a + p] = 0.01 + s * (0.99);\n            }\n        }\n        c[truncate(f) * a + truncate(f)] = 1;\n        return c;\n    };\n    HeatTileGeneratorWorker.prototype.q = function (a, b) {\n        return truncate(Math.floor(b * 2));\n    };\n    HeatTileGeneratorWorker.prototype.z = function () {\n        var _this = this;\n        if (this.completedSink == null) {\n            return;\n        }\n        this.completedSink.onCompleted(((function () {\n            var $ret = new HeatTileImageCreatedEventArgs();\n            $ret.url = _this.w;\n            $ret.x = _this.n;\n            $ret.y = _this.o;\n            $ret.z = _this.p;\n            $ret.globalMinimumValue = _this.g.globalMinimum;\n            $ret.globalMaximumValue = _this.g.globalMaximum;\n            $ret.globalMaximumValueLongitude = _this.j;\n            $ret.globalMaximumValueLatitude = _this.i;\n            $ret.globalMinimumValueLongitude = _this.l;\n            $ret.globalMinimumValueLatitude = _this.k;\n            $ret.imageData = _this.a;\n            $ret.image = _this.g.image;\n            return $ret;\n        })()));\n    };\n    Object.defineProperty(HeatTileGeneratorWorker.prototype, \"completedSink\", {\n        get: function () {\n            return this._completedSink;\n        },\n        set: function (a) {\n            this._completedSink = a;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HeatTileGeneratorWorker.$t = markType(HeatTileGeneratorWorker, 'HeatTileGeneratorWorker');\n    HeatTileGeneratorWorker.v = {};\n    HeatTileGeneratorWorker.s = 0;\n    HeatTileGeneratorWorker.m = 0;\n    return HeatTileGeneratorWorker;\n}(Base));\nexport { HeatTileGeneratorWorker };\n//# sourceMappingURL=HeatTileGeneratorWorker.js.map\n"]},"metadata":{},"sourceType":"module"}